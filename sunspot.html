<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>AN560: Sam LeBlanc â€“ sunspot</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./conc.html" rel="next">
<link href="./ftsm.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>
        <script type="text/javascript">
        window.PlotlyConfig = {MathJaxConfig: 'local'};
        if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}
        if (typeof require !== 'undefined') {
        require.undef("plotly");
        requirejs.config({
            paths: {
                'plotly': ['https://cdn.plot.ly/plotly-2.18.0.min']
            }
        });
        require(['plotly'], function(Plotly) {
            window._Plotly = Plotly;
        });
        }
        </script>
        


</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title"></h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="./index.html" class="sidebar-logo-link">
      <img src="./images/gg.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">Introduction</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./me.html" class="sidebar-item-text sidebar-link">About Me</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ds.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dv.html" class="sidebar-item-text sidebar-link">Data Visualizations</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./eda.html" class="sidebar-item-text sidebar-link">Exploratory Data Analysis</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arma.html" class="sidebar-item-text sidebar-link">ARMA/ARIMA/SARIMA Models</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./arimax.html" class="sidebar-item-text sidebar-link">ARIMAX/SARIMAX/VAR</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ftsm.html" class="sidebar-item-text sidebar-link">Financial Time Series Models (ARCH/GARCH)</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./sunspot.html" class="sidebar-item-text sidebar-link active">Deep Learning for TS</a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./conc.html" class="sidebar-item-text sidebar-link">Conclusions</a>
  </div>
</li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#import-package-and-set-user-parameters" id="toc-import-package-and-set-user-parameters" class="nav-link active" data-scroll-target="#import-package-and-set-user-parameters">Import package and set user parameters</a></li>
  <li><a href="#download-and-explore-data" id="toc-download-and-explore-data" class="nav-link" data-scroll-target="#download-and-explore-data">Download and explore data</a></li>
  <li><a href="#visualization-plotting-function" id="toc-visualization-plotting-function" class="nav-link" data-scroll-target="#visualization-plotting-function">Visualization plotting function</a></li>
  <li><a href="#visualize" id="toc-visualize" class="nav-link" data-scroll-target="#visualize">Visualize</a></li>
  <li><a href="#utility-function-test-train-split-data" id="toc-utility-function-test-train-split-data" class="nav-link" data-scroll-target="#utility-function-test-train-split-data">Utility function: test-train split data</a></li>
  <li><a href="#visualize-training-test-split" id="toc-visualize-training-test-split" class="nav-link" data-scroll-target="#visualize-training-test-split">Visualize: training-test split</a></li>
  <li><a href="#re-format-data-into-required-shape" id="toc-re-format-data-into-required-shape" class="nav-link" data-scroll-target="#re-format-data-into-required-shape">Re-format data into required shape</a></li>
  <li><a href="#visualize-1" id="toc-visualize-1" class="nav-link" data-scroll-target="#visualize-1">Visualize</a></li>
  <li><a href="#model-and-training-parameters" id="toc-model-and-training-parameters" class="nav-link" data-scroll-target="#model-and-training-parameters">Model and training parameters</a></li>
  <li><a href="#create-model" id="toc-create-model" class="nav-link" data-scroll-target="#create-model">Create model</a></li>
  <li><a href="#train-model" id="toc-train-model" class="nav-link" data-scroll-target="#train-model">Train model</a></li>
  <li><a href="#visualize-fitting-history" id="toc-visualize-fitting-history" class="nav-link" data-scroll-target="#visualize-fitting-history">Visualize fitting history</a></li>
  <li><a href="#visualize-parity-plot" id="toc-visualize-parity-plot" class="nav-link" data-scroll-target="#visualize-parity-plot">Visualize parity plot</a></li>
  <li><a href="#visualize-predictions-2" id="toc-visualize-predictions-2" class="nav-link" data-scroll-target="#visualize-predictions-2">Visualize predictions-2</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<section id="import-package-and-set-user-parameters" class="level2">
<h2 class="anchored" data-anchor-id="import-package-and-set-user-parameters">Import package and set user parameters</h2>
<div class="cell" data-scrolled="true" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.models <span class="im">import</span> Sequential</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> keras.layers <span class="im">import</span> Dense, SimpleRNN,LSTM,GRU</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> MinMaxScaler</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.express <span class="im">as</span> px</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>pio.renderers.default <span class="op">=</span> <span class="st">"plotly_mimetype+notebook_connected"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="download-and-explore-data" class="level2">
<h2 class="anchored" data-anchor-id="download-and-explore-data">Download and explore data</h2>
<p><img src="img/2023-04-19-13-54-12.png" class="img-fluid"></p>
<div class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">'co2.csv'</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df[[<span class="st">'year'</span>,<span class="st">'month'</span>,<span class="st">'average'</span>]]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     year  month  average
0    1958      3   315.70
1    1958      4   317.45
2    1958      5   317.51
3    1958      6   317.24
4    1958      7   315.86
..    ...    ...      ...
773  2022      8   417.19
774  2022      9   415.95
775  2022     10   415.78
776  2022     11   417.51
777  2022     12   418.95

[778 rows x 3 columns]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> np.array(df[<span class="st">"average"</span>].values.astype(<span class="st">'float32'</span>)).reshape(df.shape[<span class="dv">0</span>],<span class="dv">1</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(778, 1)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(X[<span class="dv">0</span>:<span class="dv">10</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[315.7 ]
 [317.45]
 [317.51]
 [317.24]
 [315.86]
 [314.93]
 [313.2 ]
 [312.43]
 [313.33]
 [314.67]]</code></pre>
</div>
</div>
</section>
<section id="visualization-plotting-function" class="level2">
<h2 class="anchored" data-anchor-id="visualization-plotting-function">Visualization plotting function</h2>
<div class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotly_line_plot(t,y,title<span class="op">=</span><span class="st">"Plot"</span>, x_label<span class="op">=</span><span class="st">"Months since March 1958"</span>, y_label<span class="op">=</span><span class="st">"CO2 Concentration"</span>):</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> px.line(x<span class="op">=</span>t[<span class="dv">0</span>],y<span class="op">=</span>y[<span class="dv">0</span>], title<span class="op">=</span>title, render_mode<span class="op">=</span><span class="st">'SVG'</span>)  </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="bu">len</span>(y)):</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> <span class="bu">len</span>(t[i])<span class="op">==</span><span class="dv">1</span>:</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>            <span class="co">#print(t[i],y[i])</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>            fig.add_scatter(x<span class="op">=</span>t[i],y<span class="op">=</span>y[i])</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span>:</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>            fig.add_scatter(x<span class="op">=</span>t[i],y<span class="op">=</span>y[i], mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    fig.update_layout(</span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>        xaxis_title<span class="op">=</span>x_label,</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>        yaxis_title<span class="op">=</span>y_label,</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>        template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>        showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>    fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualize" class="level2">
<h2 class="anchored" data-anchor-id="visualize">Visualize</h2>
<div class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SINGLE SERIES </span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>t<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(X))]</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([t],[X[:,<span class="dv">0</span>]],title<span class="op">=</span><span class="st">"Atmospheric CO2 Concentration since March 1958"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="dcd94285-134e-4f62-bb32-086058eaa5d5" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("dcd94285-134e-4f62-bb32-086058eaa5d5")) {                    Plotly.newPlot(                        "dcd94285-134e-4f62-bb32-086058eaa5d5",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621,622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777],"xaxis":"x","y":[315.70001220703125,317.45001220703125,317.510009765625,317.239990234375,315.8599853515625,314.92999267578125,313.20001220703125,312.42999267578125,313.3299865722656,314.6700134277344,315.5799865722656,316.4800109863281,316.6499938964844,317.7200012207031,318.2900085449219,318.1499938964844,316.5400085449219,314.79998779296875,313.8399963378906,313.3299865722656,314.80999755859375,315.5799865722656,316.42999267578125,316.9800109863281,317.5799865722656,319.0299987792969,320.0400085449219,319.5899963378906,318.17999267578125,315.8999938964844,314.1700134277344,313.8299865722656,315.0,316.19000244140625,316.8900146484375,317.70001220703125,318.5400085449219,319.4800109863281,320.5799865722656,319.7699890136719,318.57000732421875,316.7900085449219,314.989990234375,315.30999755859375,316.1000061035156,317.010009765625,317.94000244140625,318.54998779296875,319.67999267578125,320.57000732421875,321.0199890136719,320.6199951171875,319.6099853515625,317.3999938964844,316.25,315.4200134277344,316.69000244140625,317.70001220703125,318.739990234375,319.07000732421875,319.8599853515625,321.3800048828125,322.25,321.4800109863281,319.739990234375,317.7699890136719,316.2099914550781,315.989990234375,317.07000732421875,318.3500061035156,319.57000732421875,320.010009765625,320.739990234375,321.8399963378906,322.260009765625,321.8900146484375,320.44000244140625,318.69000244140625,316.70001220703125,316.8699951171875,317.67999267578125,318.7099914550781,319.44000244140625,320.44000244140625,320.8900146484375,322.1400146484375,322.1700134277344,321.8699951171875,321.2099914550781,318.8699951171875,317.80999755859375,317.29998779296875,318.8699951171875,319.4200134277344,320.6199951171875,321.6000061035156,322.3900146484375,323.70001220703125,324.0799865722656,323.75,322.3800048828125,320.3599853515625,318.6400146484375,318.1000061035156,319.7799987792969,321.0299987792969,322.3299865722656,322.5,323.0400085449219,324.4200134277344,325.0,324.0899963378906,322.5400085449219,320.9200134277344,319.25,319.3900146484375,320.7300109863281,321.9599914550781,322.57000732421875,323.1499938964844,323.8900146484375,325.0199890136719,325.57000732421875,325.3599853515625,324.1400146484375,322.1099853515625,320.3299865722656,320.25,321.32000732421875,322.8900146484375,324.0,324.4200134277344,325.6300048828125,326.6600036621094,327.3800048828125,326.7099914550781,325.8800048828125,323.6600036621094,322.3800048828125,321.7799987792969,322.8599853515625,324.1199951171875,325.05999755859375,325.9800109863281,326.92999267578125,328.1300048828125,328.0799865722656,327.6700134277344,326.3399963378906,324.69000244140625,323.1000061035156,323.05999755859375,324.010009765625,325.1300048828125,326.1700134277344,326.67999267578125,327.1700134277344,327.7900085449219,328.92999267578125,328.57000732421875,327.3599853515625,325.42999267578125,323.3599853515625,323.55999755859375,324.79998779296875,326.010009765625,326.7699890136719,327.6300048828125,327.75,329.7200012207031,330.07000732421875,329.0899963378906,328.0400085449219,326.32000732421875,324.8399963378906,325.20001220703125,326.5,327.54998779296875,328.54998779296875,329.55999755859375,330.29998779296875,331.5,332.4800109863281,332.07000732421875,330.8699951171875,329.30999755859375,327.510009765625,327.17999267578125,328.1600036621094,328.6400146484375,329.3500061035156,330.7099914550781,331.4800109863281,332.6499938964844,333.17999267578125,332.20001220703125,331.07000732421875,329.1499938964844,327.3299865722656,327.2799987792969,328.30999755859375,329.5799865722656,330.7300109863281,331.4599914550781,331.94000244140625,333.1099853515625,333.95001220703125,333.4200134277344,331.9700012207031,329.95001220703125,328.5,328.3599853515625,329.3800048828125,330.7900085449219,331.55999755859375,332.739990234375,333.3599853515625,334.739990234375,334.7200012207031,333.9800109863281,333.0799865722656,330.67999267578125,328.9599914550781,328.7200012207031,330.1600036621094,331.6199951171875,332.67999267578125,333.1700134277344,334.9599914550781,336.1400146484375,336.92999267578125,336.1700134277344,334.8900146484375,332.55999755859375,331.2900085449219,331.2799987792969,332.4599914550781,333.6000061035156,334.94000244140625,335.260009765625,336.6600036621094,337.69000244140625,338.0199890136719,338.010009765625,336.5,334.4200134277344,332.3599853515625,332.45001220703125,333.760009765625,334.9100036621094,336.1400146484375,336.69000244140625,338.2699890136719,338.82000732421875,339.239990234375,339.260009765625,337.5400085449219,335.7200012207031,333.9700012207031,334.239990234375,335.32000732421875,336.80999755859375,337.8999938964844,338.3399963378906,340.07000732421875,340.92999267578125,341.45001220703125,341.3599853515625,339.45001220703125,337.6700134277344,336.25,336.1400146484375,337.29998779296875,338.2900085449219,339.2900085449219,340.54998779296875,341.6300048828125,342.6000061035156,343.0400085449219,342.5400085449219,340.82000732421875,338.4800109863281,336.95001220703125,337.04998779296875,338.5799865722656,339.9100036621094,340.92999267578125,341.760009765625,342.7699890136719,343.9599914550781,344.7699890136719,343.8800048828125,342.4200134277344,340.239990234375,338.3800048828125,338.4100036621094,339.44000244140625,340.7799987792969,341.57000732421875,342.7900085449219,343.3699951171875,345.3999938964844,346.1400146484375,345.760009765625,344.32000732421875,342.510009765625,340.4599914550781,340.5299987792969,341.7900085449219,343.20001220703125,344.2099914550781,344.9200134277344,345.67999267578125,347.3699951171875,347.7799987792969,347.1600036621094,345.7900085449219,343.739990234375,341.5899963378906,341.8599853515625,343.30999755859375,345.0,345.4800109863281,346.4100036621094,347.9100036621094,348.6600036621094,349.2799987792969,348.6499938964844,346.8999938964844,345.260009765625,343.4700012207031,343.3500061035156,344.7300109863281,346.1199951171875,346.7799987792969,347.4800109863281,348.25,349.8599853515625,350.5199890136719,349.9800109863281,348.25,346.1700134277344,345.4800109863281,344.82000732421875,346.2200012207031,347.489990234375,348.7300109863281,348.9200134277344,349.80999755859375,351.3999938964844,352.1499938964844,351.5799865722656,350.2099914550781,348.20001220703125,346.6600036621094,346.7200012207031,348.0799865722656,349.2799987792969,350.510009765625,351.70001220703125,352.5,353.6700134277344,354.3500061035156,353.8800048828125,352.79998779296875,350.489990234375,348.9700012207031,349.3699951171875,350.4200134277344,351.6199951171875,353.07000732421875,353.42999267578125,354.0799865722656,355.7200012207031,355.95001220703125,355.44000244140625,354.04998779296875,351.8399963378906,350.0899963378906,350.3299865722656,351.54998779296875,352.9100036621094,353.8599853515625,355.1000061035156,355.75,356.3800048828125,357.3800048828125,356.3900146484375,354.8900146484375,353.05999755859375,351.3800048828125,351.69000244140625,353.1400146484375,354.4100036621094,354.92999267578125,355.82000732421875,357.3299865722656,358.7699890136719,359.2300109863281,358.2300109863281,356.29998779296875,353.9700012207031,352.3399963378906,352.42999267578125,353.8900146484375,355.2099914550781,356.3399963378906,357.2099914550781,357.9700012207031,359.2200012207031,359.7099914550781,359.44000244140625,357.1499938964844,354.989990234375,353.010009765625,353.4100036621094,354.4200134277344,355.67999267578125,357.1000061035156,357.4200134277344,358.5899963378906,359.3900146484375,360.29998779296875,359.6400146484375,357.45001220703125,355.760009765625,354.1400146484375,354.2300109863281,355.5299987792969,357.0299987792969,358.3599853515625,359.0400085449219,360.1099853515625,361.3599853515625,361.7799987792969,360.94000244140625,359.510009765625,357.5899963378906,355.8599853515625,356.2099914550781,357.6499938964844,359.1000061035156,360.0400085449219,361.0,361.9800109863281,363.44000244140625,363.8299865722656,363.3299865722656,361.7799987792969,359.3299865722656,358.32000732421875,358.1400146484375,359.6099853515625,360.82000732421875,362.20001220703125,363.3599853515625,364.2799987792969,364.69000244140625,365.25,365.05999755859375,363.69000244140625,361.54998779296875,359.69000244140625,359.7200012207031,361.0400085449219,362.3900146484375,363.239990234375,364.2099914550781,364.6499938964844,366.489990234375,366.7699890136719,365.7300109863281,364.4599914550781,362.3999938964844,360.44000244140625,360.9800109863281,362.6499938964844,364.510009765625,365.3900146484375,366.1000061035156,367.3599853515625,368.7900085449219,369.55999755859375,369.1300048828125,367.9800109863281,366.1000061035156,364.1600036621094,364.5400085449219,365.6700134277344,367.29998779296875,368.3500061035156,369.2799987792969,369.8399963378906,371.1499938964844,371.1199951171875,370.4599914550781,369.6099853515625,367.05999755859375,364.95001220703125,365.5199890136719,366.8800048828125,368.260009765625,369.45001220703125,369.7099914550781,370.75,371.9800109863281,371.75,371.8699951171875,370.0199890136719,368.2699890136719,367.1499938964844,367.17999267578125,368.5299987792969,369.8299865722656,370.760009765625,371.69000244140625,372.6300048828125,373.54998779296875,374.0299987792969,373.3999938964844,371.67999267578125,369.7799987792969,368.3399963378906,368.6099853515625,369.94000244140625,371.4200134277344,372.70001220703125,373.3699951171875,374.29998779296875,375.19000244140625,375.92999267578125,375.69000244140625,374.1600036621094,372.0299987792969,370.9200134277344,370.7300109863281,372.42999267578125,373.9800109863281,375.07000732421875,375.82000732421875,376.6400146484375,377.9200134277344,378.7799987792969,378.4599914550781,376.8800048828125,374.57000732421875,373.3399963378906,373.30999755859375,374.8399963378906,376.1700134277344,377.1700134277344,378.04998779296875,379.05999755859375,380.5400085449219,380.79998779296875,379.8699951171875,377.6499938964844,376.1700134277344,374.42999267578125,374.6300048828125,376.3299865722656,377.67999267578125,378.6300048828125,379.9100036621094,380.95001220703125,382.4800109863281,382.6400146484375,382.3999938964844,380.92999267578125,378.92999267578125,376.8900146484375,377.19000244140625,378.5400085449219,380.30999755859375,381.5799865722656,382.3999938964844,382.8599853515625,384.79998779296875,385.2200012207031,384.239990234375,382.6499938964844,380.6000061035156,379.0400085449219,379.3299865722656,380.3500061035156,382.0199890136719,383.1000061035156,384.1199951171875,384.80999755859375,386.7300109863281,386.7799987792969,386.3299865722656,384.7300109863281,382.239990234375,381.20001220703125,381.3699951171875,382.70001220703125,384.19000244140625,385.7799987792969,386.05999755859375,386.2799987792969,387.3299865722656,388.7799987792969,387.989990234375,386.6099853515625,384.32000732421875,383.4100036621094,383.2099914550781,384.4100036621094,385.7900085449219,387.1700134277344,387.70001220703125,389.0400085449219,389.760009765625,390.3599853515625,389.70001220703125,388.239990234375,386.2900085449219,384.95001220703125,384.6400146484375,386.2300109863281,387.6300048828125,388.9100036621094,390.4100036621094,391.3699951171875,392.6700134277344,393.2099914550781,392.3800048828125,390.4100036621094,388.5400085449219,387.0299987792969,387.42999267578125,388.8699951171875,389.989990234375,391.5,392.04998779296875,392.79998779296875,393.44000244140625,394.4100036621094,393.95001220703125,392.7200012207031,390.3299865722656,389.2799987792969,389.19000244140625,390.4800109863281,392.05999755859375,393.30999755859375,394.0400085449219,394.5899963378906,396.3800048828125,396.92999267578125,395.9100036621094,394.55999755859375,392.5899963378906,391.32000732421875,391.2699890136719,393.20001220703125,394.57000732421875,395.7799987792969,397.0299987792969,397.6600036621094,398.6400146484375,400.0199890136719,398.80999755859375,397.510009765625,395.3900146484375,393.7200012207031,393.8999938964844,395.3599853515625,397.0299987792969,398.0400085449219,398.2699890136719,399.9100036621094,401.510009765625,401.9599914550781,401.42999267578125,399.2699890136719,397.17999267578125,395.5400085449219,396.1600036621094,397.3999938964844,399.0799865722656,400.17999267578125,400.54998779296875,401.739990234375,403.3500061035156,404.1499938964844,402.9700012207031,401.4599914550781,399.1099853515625,397.82000732421875,398.489990234375,400.2699890136719,402.05999755859375,402.7300109863281,404.25,405.05999755859375,407.6000061035156,407.8999938964844,406.989990234375,404.5899963378906,402.45001220703125,401.2300109863281,401.7900085449219,403.7200012207031,404.6400146484375,406.3599853515625,406.6600036621094,407.5400085449219,409.2200012207031,409.8900146484375,409.0799865722656,407.3299865722656,405.32000732421875,403.57000732421875,403.82000732421875,405.30999755859375,407.0,408.1499938964844,408.5199890136719,409.5899963378906,410.45001220703125,411.44000244140625,410.989990234375,408.8999938964844,407.1600036621094,405.7099914550781,406.19000244140625,408.2099914550781,409.2699890136719,411.0299987792969,411.9599914550781,412.17999267578125,413.5400085449219,414.8599853515625,414.1600036621094,411.9700012207031,410.17999267578125,408.760009765625,408.75,410.4800109863281,411.9800109863281,413.6099853515625,414.3399963378906,414.739990234375,416.45001220703125,417.30999755859375,416.6000061035156,414.6199951171875,412.7799987792969,411.5199890136719,411.510009765625,413.1199951171875,414.260009765625,415.5199890136719,416.75,417.6400146484375,419.04998779296875,419.1300048828125,418.94000244140625,416.9599914550781,414.4700012207031,413.29998779296875,413.92999267578125,415.010009765625,416.7099914550781,418.19000244140625,419.2799987792969,418.80999755859375,420.2300109863281,420.989990234375,420.989990234375,418.8999938964844,417.19000244140625,415.95001220703125,415.7799987792969,417.510009765625,418.95001220703125],"yaxis":"y","type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Months since March 1958"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"CO2 Concentration"}},"legend":{"tracegroupgap":0},"title":{"text":"Atmospheric CO2 Concentration since March 1958"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('dcd94285-134e-4f62-bb32-086058eaa5d5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="utility-function-test-train-split-data" class="level2">
<h2 class="anchored" data-anchor-id="utility-function-test-train-split-data">Utility function: test-train split data</h2>
<div class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Parameter split_percent defines the ratio of training examples</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_train_test(data, split_percent<span class="op">=</span><span class="fl">0.8</span>):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>    scaler <span class="op">=</span> MinMaxScaler(feature_range<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>    data <span class="op">=</span> scaler.fit_transform(data).flatten()</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>    n <span class="op">=</span> <span class="bu">len</span>(data)</span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Point for splitting data into train and test</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>    split <span class="op">=</span> <span class="bu">int</span>(n<span class="op">*</span>split_percent)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>    train_data <span class="op">=</span> data[<span class="bu">range</span>(split)]</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>    test_data <span class="op">=</span> data[split:]</span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> train_data, test_data, data</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>train_data, test_data, data <span class="op">=</span> get_train_test(X)</span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(train_data.shape)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(test_data.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(622,)
(156,)</code></pre>
</div>
</div>
</section>
<section id="visualize-training-test-split" class="level2">
<h2 class="anchored" data-anchor-id="visualize-training-test-split">Visualize: training-test split</h2>
<div class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SINGLE SERIES </span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>t1<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(train_data))]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>t2<span class="op">=</span><span class="bu">len</span>(train_data)<span class="op">+</span>np.array([<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(test_data))])</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([t1,t2],[train_data,test_data],title<span class="op">=</span><span class="st">"Sunspots per month since 1749-01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="95aaf255-2cd3-4142-8848-d09956957f01" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("95aaf255-2cd3-4142-8848-d09956957f01")) {                    Plotly.newPlot(                        "95aaf255-2cd3-4142-8848-d09956957f01",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384,385,386,387,388,389,390,391,392,393,394,395,396,397,398,399,400,401,402,403,404,405,406,407,408,409,410,411,412,413,414,415,416,417,418,419,420,421,422,423,424,425,426,427,428,429,430,431,432,433,434,435,436,437,438,439,440,441,442,443,444,445,446,447,448,449,450,451,452,453,454,455,456,457,458,459,460,461,462,463,464,465,466,467,468,469,470,471,472,473,474,475,476,477,478,479,480,481,482,483,484,485,486,487,488,489,490,491,492,493,494,495,496,497,498,499,500,501,502,503,504,505,506,507,508,509,510,511,512,513,514,515,516,517,518,519,520,521,522,523,524,525,526,527,528,529,530,531,532,533,534,535,536,537,538,539,540,541,542,543,544,545,546,547,548,549,550,551,552,553,554,555,556,557,558,559,560,561,562,563,564,565,566,567,568,569,570,571,572,573,574,575,576,577,578,579,580,581,582,583,584,585,586,587,588,589,590,591,592,593,594,595,596,597,598,599,600,601,602,603,604,605,606,607,608,609,610,611,612,613,614,615,616,617,618,619,620,621],"xaxis":"x","y":[0.030121803283691406,0.04624176025390625,0.04679441452026367,0.04430723190307617,0.03159523010253906,0.02302861213684082,0.007092952728271484,0.0,0.008290290832519531,0.020633935928344727,0.02901601791381836,0.037306785583496094,0.038872480392456055,0.04872894287109375,0.05397939682006836,0.05268979072570801,0.037859439849853516,0.021831274032592773,0.012988090515136719,0.008290290832519531,0.021923303604125977,0.02901601791381836,0.03684592247009277,0.04191255569458008,0.0474390983581543,0.06079578399658203,0.0700995922088623,0.06595420837402344,0.05296611785888672,0.03196382522583008,0.016028165817260742,0.012896060943603516,0.023673534393310547,0.034635305404663086,0.041083335876464844,0.04854464530944824,0.05628228187561035,0.0649411678314209,0.0750737190246582,0.0676124095916748,0.05655860900878906,0.04016232490539551,0.023581266403198242,0.02652907371520996,0.03380632400512695,0.04218888282775879,0.05075550079345703,0.056374311447143555,0.06678342819213867,0.074981689453125,0.07912659645080566,0.07544207572937012,0.06613850593566895,0.04578113555908203,0.03518795967102051,0.027542591094970703,0.03924107551574707,0.04854464530944824,0.058124542236328125,0.06116437911987305,0.06844139099121094,0.0824429988861084,0.09045696258544922,0.08336424827575684,0.0673360824584961,0.04918932914733887,0.03481936454772949,0.03279280662536621,0.04274153709411621,0.05453205108642578,0.06577014923095703,0.0698232650756836,0.07654738426208496,0.08668017387390137,0.09054923057556152,0.08714103698730469,0.07378411293029785,0.057663917541503906,0.039333343505859375,0.040899038314819336,0.048360347747802734,0.057848215103149414,0.06457257270812988,0.07378411293029785,0.07792949676513672,0.08944368362426758,0.08972001075744629,0.08695650100708008,0.08087682723999023,0.05932211875915527,0.04955792427062988,0.044859886169433594,0.05932211875915527,0.06438851356506348,0.07544207572937012,0.08446955680847168,0.09174656867980957,0.10381364822387695,0.10731387138366699,0.10427427291870117,0.09165453910827637,0.07304716110229492,0.05720353126525879,0.05222916603088379,0.06770443916320801,0.07921886444091797,0.09119367599487305,0.09275984764099121,0.09773397445678711,0.11044597625732422,0.11578845977783203,0.1074061393737793,0.09312844276428223,0.07820582389831543,0.06282234191894531,0.06411218643188477,0.07645559310913086,0.08778548240661621,0.09340476989746094,0.09874725341796875,0.10556387901306152,0.11597275733947754,0.12103915214538574,0.11910462379455566,0.10786676406860352,0.08916711807250977,0.07277083396911621,0.07203388214111328,0.08189034461975098,0.09635233879089355,0.10657715797424316,0.11044597625732422,0.12159180641174316,0.13107967376708984,0.1377120018005371,0.13154006004333496,0.12389469146728516,0.10344505310058594,0.09165453910827637,0.08612751960754395,0.09607577323913574,0.10768246650695801,0.11634111404418945,0.1248159408569336,0.13356661796569824,0.14462065696716309,0.14415979385375977,0.14038324356079102,0.12813186645507812,0.11293292045593262,0.09828686714172363,0.09791827201843262,0.10666918754577637,0.11698603630065918,0.12656617164611816,0.13126373291015625,0.13577771186828613,0.14148879051208496,0.15198969841003418,0.14867353439331055,0.1375274658203125,0.11974930763244629,0.10068154335021973,0.1025240421295166,0.11394619941711426,0.1250922679901123,0.13209271430969238,0.1400148868560791,0.14112019538879395,0.15926671028137207,0.1624908447265625,0.15346360206604004,0.14379167556762695,0.12794780731201172,0.11431455612182617,0.1176309585571289,0.12960577011108398,0.13927769660949707,0.14848923683166504,0.1577930450439453,0.16460943222045898,0.17566323280334473,0.1846907138824463,0.18091392517089844,0.1698598861694336,0.15549015998840332,0.13890957832336426,0.13586950302124023,0.1448969841003418,0.14931845664978027,0.15585851669311523,0.16838622093200684,0.17547917366027832,0.18625640869140625,0.19113850593566895,0.18211150169372559,0.17170238494873047,0.15401625633239746,0.1372511386871338,0.13679075241088867,0.14627861976623535,0.15797710418701172,0.16857051849365234,0.1752946376800537,0.1797163486480713,0.19049358367919922,0.19823145866394043,0.19334936141967773,0.17999267578125,0.16138553619384766,0.14802885055541992,0.14673900604248047,0.15613484382629395,0.16912317276000977,0.17621588706970215,0.18708539009094238,0.1927964687347412,0.20550847053527832,0.20532441139221191,0.19850778579711914,0.1902172565460205,0.16810965538024902,0.1522660255432129,0.1500554084777832,0.16331982612609863,0.17676854133605957,0.18653273582458496,0.19104647636413574,0.2075350284576416,0.21840476989746094,0.22568154335021973,0.21868109703063965,0.20689034461975098,0.18542742729187012,0.17372894287109375,0.17363667488098145,0.18450617790222168,0.1950075626373291,0.2073507308959961,0.2102985382080078,0.22319459915161133,0.232682466506958,0.23572206497192383,0.23563027381896973,0.22172069549560547,0.2025609016418457,0.18358492851257324,0.18441438674926758,0.19648122787475586,0.20707440376281738,0.21840476989746094,0.22347092628479004,0.23802495002746582,0.24309158325195312,0.24696016311645508,0.24714446067810059,0.23130083084106445,0.21453571319580078,0.19841575622558594,0.20090270042419434,0.21085119247436523,0.22457623481750488,0.23461675643920898,0.23866987228393555,0.254605770111084,0.2625277042388916,0.2673177719116211,0.26648855209350586,0.24889469146728516,0.2324984073638916,0.21941781044006348,0.21840476989746094,0.22908973693847656,0.23820948600769043,0.2474207878112793,0.25902724266052246,0.26897573471069336,0.2779109477996826,0.2819640636444092,0.2773582935333252,0.26151442527770996,0.239959716796875,0.22586607933044434,0.22678685188293457,0.24088048934936523,0.2531318664550781,0.2625277042388916,0.2701733112335205,0.2794766426086426,0.2904384136199951,0.2978997230529785,0.2897017002105713,0.27625298500061035,0.25617170333862305,0.23903846740722656,0.23931479454040527,0.24880266189575195,0.26114583015441895,0.26842308044433594,0.2796611785888672,0.285003662109375,0.30370306968688965,0.3105196952819824,0.3070192337036133,0.29375481605529785,0.2770819664001465,0.25819826126098633,0.25884318351745605,0.2704496383666992,0.28343796730041504,0.2927412986755371,0.29928159713745117,0.30628228187561035,0.3218495845794678,0.3256263732910156,0.3199152946472168,0.307295560836792,0.28841185569763184,0.26860713958740234,0.27109432220458984,0.2844510078430176,0.3000185489654541,0.3044400215148926,0.3130066394805908,0.3268239498138428,0.33373260498046875,0.3394436836242676,0.33364033699035645,0.3175201416015625,0.3024134635925293,0.28592491149902344,0.2848196029663086,0.2975313663482666,0.3103353977203369,0.31641483306884766,0.3228631019592285,0.3299558162689209,0.3447861671447754,0.35086584091186523,0.34589171409606934,0.3299558162689209,0.31079602241516113,0.3044400215148926,0.29836034774780273,0.31125640869140625,0.3229548931121826,0.3343775272369385,0.33612775802612305,0.3443257808685303,0.35897207260131836,0.36588072776794434,0.3606300354003906,0.3480103015899658,0.3294954299926758,0.3153095245361328,0.31586217880249023,0.32838964462280273,0.3394436836242676,0.35077381134033203,0.36173558235168457,0.36910462379455566,0.3798823356628418,0.38614606857299805,0.3818166255950928,0.3718681335449219,0.3505895137786865,0.33658814430236816,0.3402726650238037,0.3499448299407959,0.36099863052368164,0.3743553161621094,0.3776712417602539,0.38365864753723145,0.39876580238342285,0.40088438987731934,0.39618659019470215,0.38338232040405273,0.3630251884460449,0.346904993057251,0.34911561012268066,0.3603537082672119,0.3728814125061035,0.38163208961486816,0.393054723739624,0.39904212951660156,0.4048452377319336,0.41405677795410156,0.4049375057220459,0.39112019538879395,0.37426304817199707,0.35878777503967285,0.36164331436157227,0.3750002384185791,0.38669872283935547,0.39148855209350586,0.3996868133544922,0.41359615325927734,0.4268605709075928,0.43109822273254395,0.421886682510376,0.40410828590393066,0.3826456069946289,0.3676307201385498,0.36845970153808594,0.3819088935852051,0.39406776428222656,0.4044768810272217,0.4124908447265625,0.4194915294647217,0.43100595474243164,0.4355194568634033,0.4330325126647949,0.4119381904602051,0.3920412063598633,0.37380266189575195,0.3774871826171875,0.3867909908294678,0.39839720726013184,0.41147756576538086,0.4144253730773926,0.4252026081085205,0.4325721263885498,0.44095420837402344,0.4348750114440918,0.4147017002105713,0.39913415908813477,0.38421177864074707,0.3850407600402832,0.3970155715942383,0.41083264350891113,0.423084020614624,0.4293479919433594,0.43920397758483887,0.45071840286254883,0.454587459564209,0.4468498229980469,0.43367743492126465,0.41599106788635254,0.4000551700592041,0.40327930450439453,0.41654396057128906,0.4299006462097168,0.43855953216552734,0.4474024772644043,0.45642971992492676,0.4698784351348877,0.47347092628479004,0.46886515617370605,0.454587459564209,0.4320189952850342,0.4227156639099121,0.42105770111083984,0.4345982074737549,0.44574451446533203,0.45845627784729004,0.46914148330688477,0.4776160717010498,0.48139286041259766,0.48655128479003906,0.4848010540008545,0.4721813201904297,0.4524686336517334,0.4353353977203369,0.4356117248535156,0.4477708339691162,0.4602065086364746,0.4680361747741699,0.4769711494445801,0.48102426528930664,0.4979734420776367,0.5005526542663574,0.49097299575805664,0.47927403450012207,0.4602985382080078,0.4422440528869629,0.4472181797027588,0.4626014232635498,0.4797348976135254,0.4878411293029785,0.4943811893463135,0.5059874057769775,0.5191600322723389,0.5262527465820312,0.522291898727417,0.5116987228393555,0.4943811893463135,0.47651076316833496,0.4800112247467041,0.4904203414916992,0.5054347515106201,0.5151069164276123,0.5236735343933105,0.528831958770752,0.5408990383148193,0.5406227111816406,0.5345430374145508,0.5267133712768555,0.5032241344451904,0.48378801345825195,0.48903822898864746,0.5015661716461182,0.5142779350280762,0.5252397060394287,0.5276343822479248,0.5372145175933838,0.5485446453094482,0.5464260578155518,0.5475313663482666,0.5304899215698242,0.5143699645996094,0.5040531158447266,0.5043294429779053,0.5167648792266846,0.5287396907806396,0.5373067855834961,0.5458734035491943,0.5545320510864258,0.5630066394805908,0.5674281120300293,0.5616250038146973,0.545781135559082,0.5282793045043945,0.5150146484375,0.5175018310546875,0.5297532081604004,0.5433862209320068,0.5551769733428955,0.5613486766815186,0.5699152946472168,0.5781135559082031,0.5849299430847168,0.5827193260192871,0.5686256885528564,0.5490052700042725,0.538780689239502,0.5370304584503174,0.552689790725708,0.5669677257537842,0.5770082473754883,0.5839169025421143,0.5914702415466309,0.6032609939575195,0.611182689666748,0.6082351207733154,0.5936810970306396,0.5724024772644043,0.5610723495483398,0.5607960224151611,0.5748894214630127,0.5871410369873047,0.5963523387908936,0.6044583320617676,0.6137619018554688,0.6273951530456543,0.6297898292541504,0.6212232112884521,0.600773811340332,0.5871410369873047,0.5711126327514648,0.5729551315307617,0.5886144638061523,0.6010501384735107,0.6098010540008545,0.6215918064117432,0.6311719417572021,0.6452653408050537,0.6467392444610596,0.6445283889770508,0.6309874057769775,0.6125645637512207,0.5937731266021729,0.5965366363525391,0.6089720726013184,0.6252763271331787,0.6369748115539551,0.6445283889770508,0.6487655639648438,0.6666359901428223,0.6705048084259033,0.6614775657653809,0.6468312740325928,0.6279478073120117,0.6135778427124023,0.6162490844726562,0.6256449222564697,0.6410279273986816,0.6509766578674316,0.660372257232666,0.6667280197143555,0.6844143867492676,0.6848747730255127,0.6807293891906738,0.6659913063049316,0.6430544853210449,0.6334748268127441,0.6350405216217041,0.647291898727417,0.6610169410705566,0.6756632328033447,0.6782424449920654,0.6802690029144287,0.6899409294128418,0.7032978534698486,0.6960206031799316,0.6833086013793945,0.6622145175933838,0.653832197189331,0.6519896984100342,0.6630434989929199,0.675755500793457,0.6884675025939941,0.6933493614196777,0.7056927680969238,0.7123250961303711,0.7178518772125244,0.7117724418640137,0.6983234882354736,0.680361270904541,0.6680178642272949,0.6651623249053955,0.6798086166381836,0.6927046775817871],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[622,623,624,625,626,627,628,629,630,631,632,633,634,635,636,637,638,639,640,641,642,643,644,645,646,647,648,649,650,651,652,653,654,655,656,657,658,659,660,661,662,663,664,665,666,667,668,669,670,671,672,673,674,675,676,677,678,679,680,681,682,683,684,685,686,687,688,689,690,691,692,693,694,695,696,697,698,699,700,701,702,703,704,705,706,707,708,709,710,711,712,713,714,715,716,717,718,719,720,721,722,723,724,725,726,727,728,729,730,731,732,733,734,735,736,737,738,739,740,741,742,743,744,745,746,747,748,749,750,751,752,753,754,755,756,757,758,759,760,761,762,763,764,765,766,767,768,769,770,771,772,773,774,775,776,777],"y":[0.7044954299926758,0.7183125019073486,0.7271554470062256,0.7391307353973389,0.7441046237945557,0.7364592552185059,0.7183125019073486,0.7010869979858398,0.6871776580810547,0.6908621788024902,0.7041268348693848,0.7144436836242676,0.7283530235290527,0.7334191799163818,0.7403278350830078,0.7462234497070312,0.7551584243774414,0.7509212493896484,0.739591121673584,0.7175755500793457,0.7079036235809326,0.7070744037628174,0.7189574241638184,0.7335114479064941,0.7450258731842041,0.7517502307891846,0.7568166255950928,0.7733051776885986,0.7783713340759277,0.7689757347106934,0.7565402984619141,0.7383935451507568,0.7266950607299805,0.7262341976165771,0.7440125942230225,0.7566323280334473,0.7677781581878662,0.7792925834655762,0.7850959300994873,0.7941231727600098,0.8068349361419678,0.7956891059875488,0.7837142944335938,0.764185905456543,0.748802661895752,0.7504606246948242,0.7639093399047852,0.7792925834655762,0.7885963916778564,0.7907147407531738,0.8058216571807861,0.8205602169036865,0.8247051239013672,0.8198230266571045,0.7999262809753418,0.7806742191314697,0.7655675411224365,0.7712786197662354,0.782700777053833,0.7981760501861572,0.8083088397979736,0.8117170333862305,0.822678804397583,0.8375093936920166,0.8448784351348877,0.8340089321136475,0.8200995922088623,0.7984523773193359,0.7865698337554932,0.7927412986755371,0.8091378211975098,0.8256263732910156,0.8317983150482178,0.8457996845245361,0.8532609939575195,0.8766582012176514,0.8794214725494385,0.8710391521453857,0.8489315509796143,0.8292191028594971,0.8179810047149658,0.8231394290924072,0.8409175872802734,0.8493921756744385,0.8652358055114746,0.8679993152618408,0.876105546951294,0.8915808200836182,0.8977525234222412,0.8902909755706787,0.8741710186004639,0.8556559085845947,0.8395359516143799,0.8418388366699219,0.8555638790130615,0.871131181716919,0.8817243576049805,0.8851325511932373,0.894989013671875,0.9029109477996826,0.9120302200317383,0.9078850746154785,0.8886330127716064,0.8726050853729248,0.8592483997344971,0.8636698722839355,0.8822770118713379,0.8920412063598633,0.9082536697387695,0.9168202877044678,0.918846845626831,0.9313745498657227,0.9435334205627441,0.9370856285095215,0.916912317276001,0.9004237651824951,0.8873436450958252,0.8872513771057129,0.9031872749328613,0.9170045852661133,0.9320189952850342,0.9387435913085938,0.9424281120300293,0.9581799507141113,0.9661016464233398,0.9595615863800049,0.9413228034973145,0.9243736267089844,0.9127671718597412,0.912675142288208,0.9275054931640625,0.9380068778991699,0.949613094329834,0.9609432220458984,0.9691417217254639,0.9821295738220215,0.9828667640686035,0.981116533279419,0.9628777503967285,0.9399411678314209,0.9291634559631348,0.9349668025970459,0.9449155330657959,0.9605748653411865,0.974207878112793,0.9842483997344971,0.9799189567565918,0.9929995536804199,1.0,1.0,0.9807479381561279,0.964996337890625,0.9535741806030273,0.9520082473754883,0.9679441452026367,0.9812088012695312],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Months since March 1958"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"CO2 Concentration"}},"legend":{"tracegroupgap":0},"title":{"text":"Sunspots per month since 1749-01"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('95aaf255-2cd3-4142-8848-d09956957f01');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="re-format-data-into-required-shape" class="level2">
<h2 class="anchored" data-anchor-id="re-format-data-into-required-shape">Re-format data into required shape</h2>
<div class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PREPARE THE INPUT X AND TARGET Y</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> get_XY(dat, time_steps,plot_data_partition<span class="op">=</span><span class="va">False</span>):</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="kw">global</span> X_ind,X,Y_ind,Y <span class="co">#use for plotting later</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># INDICES OF TARGET ARRAY</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Y_ind [  12   24   36   48 ..]; print(np.arange(1,12,1)); exit()</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    Y_ind <span class="op">=</span> np.arange(time_steps, <span class="bu">len</span>(dat), time_steps)<span class="op">;</span> <span class="co">#print(Y_ind); exit()</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>    Y <span class="op">=</span> dat[Y_ind]</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># PREPARE X</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    rows_x <span class="op">=</span> <span class="bu">len</span>(Y)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    X_ind<span class="op">=</span>[<span class="op">*</span><span class="bu">range</span>(time_steps<span class="op">*</span>rows_x)]</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="kw">del</span> X_ind[::time_steps] <span class="co">#if time_steps=10 remove every 10th entry</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> dat[X_ind]<span class="op">;</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>    <span class="co">#PLOT</span></span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(plot_data_partition):</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>        plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>        plt.plot(Y_ind, Y,<span class="st">'o'</span>,X_ind, X,<span class="st">'-'</span>)<span class="op">;</span> plt.show()<span class="op">;</span> </span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>    <span class="co">#RESHAPE INTO KERAS FORMAT</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>    X1 <span class="op">=</span> np.reshape(X, (rows_x, time_steps<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print([*X_ind]); print(X1); print(X1.shape,Y.shape); exit()</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> X1, Y</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">#PARTITION DATA</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>p<span class="op">=</span><span class="dv">12</span> <span class="co"># simpilar to AR(p) given time_steps data points, predict time_steps+1 point (make prediction one month in future)</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>testX, testY <span class="op">=</span> get_XY(test_data, p)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>trainX, trainY <span class="op">=</span> get_XY(train_data, p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(testX.shape,testY.shape)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape,trainY.shape)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(trainX))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(12, 11, 1) (12,)
(51, 11, 1) (51,)
&lt;class 'numpy.ndarray'&gt;</code></pre>
</div>
</div>
</section>
<section id="visualize-1" class="level2">
<h2 class="anchored" data-anchor-id="visualize-1">Visualize</h2>
<div class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Build list </span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>tmp1<span class="op">=</span>[]<span class="op">;</span> tmp2<span class="op">=</span>[]<span class="op">;</span> tmp3<span class="op">=</span>[]<span class="op">;</span> count<span class="op">=</span><span class="dv">0</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,trainX.shape[<span class="dv">0</span>]):</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tmp1.append()</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>    tmp1.append(count<span class="op">+</span>np.array([<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>,trainX[i,:,<span class="dv">0</span>].shape[<span class="dv">0</span>])]))</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>    tmp1.append([count<span class="op">+</span>trainX[i,:,<span class="dv">0</span>].shape[<span class="dv">0</span>]])<span class="op">;</span> <span class="co">#print(([count+trainX[i,:,0].shape[0]]))</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tmp1.append([count+trainX[i,:,0].shape[0]+1])</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>    tmp2.append(trainX[i,:,<span class="dv">0</span>])</span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    tmp2.append([trainY[i]])<span class="op">;</span> <span class="co">#print([trainY[i]])</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="co"># tmp2.append([trainY[i]])</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>    count<span class="op">+=</span>trainX[i,:,<span class="dv">0</span>].shape[<span class="dv">0</span>]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># print(i,trainX[i,:,0].shape)</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co"># print(tmp1)</span></span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a><span class="co"># print(tmp2)</span></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>plotly_line_plot(tmp1,tmp2,title<span class="op">=</span><span class="st">"Sunspots per month since 1749-01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="e6e417d3-8197-4237-b50c-011fdace4f29" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e6e417d3-8197-4237-b50c-011fdace4f29")) {                    Plotly.newPlot(                        "e6e417d3-8197-4237-b50c-011fdace4f29",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10],"xaxis":"x","y":[0.04624176025390625,0.04679441452026367,0.04430723190307617,0.03159523010253906,0.02302861213684082,0.007092952728271484,0.0,0.008290290832519531,0.020633935928344727,0.02901601791381836,0.037306785583496094],"yaxis":"y","type":"scatter"},{"x":[11],"y":[0.038872480392456055],"type":"scatter"},{"mode":"lines","x":[12,13,14,15,16,17,18,19,20,21,22],"y":[0.04872894287109375,0.05397939682006836,0.05268979072570801,0.037859439849853516,0.021831274032592773,0.012988090515136719,0.008290290832519531,0.021923303604125977,0.02901601791381836,0.03684592247009277,0.04191255569458008],"type":"scatter"},{"x":[23],"y":[0.0474390983581543],"type":"scatter"},{"mode":"lines","x":[24,25,26,27,28,29,30,31,32,33,34],"y":[0.06079578399658203,0.0700995922088623,0.06595420837402344,0.05296611785888672,0.03196382522583008,0.016028165817260742,0.012896060943603516,0.023673534393310547,0.034635305404663086,0.041083335876464844,0.04854464530944824],"type":"scatter"},{"x":[35],"y":[0.05628228187561035],"type":"scatter"},{"mode":"lines","x":[36,37,38,39,40,41,42,43,44,45,46],"y":[0.0649411678314209,0.0750737190246582,0.0676124095916748,0.05655860900878906,0.04016232490539551,0.023581266403198242,0.02652907371520996,0.03380632400512695,0.04218888282775879,0.05075550079345703,0.056374311447143555],"type":"scatter"},{"x":[47],"y":[0.06678342819213867],"type":"scatter"},{"mode":"lines","x":[48,49,50,51,52,53,54,55,56,57,58],"y":[0.074981689453125,0.07912659645080566,0.07544207572937012,0.06613850593566895,0.04578113555908203,0.03518795967102051,0.027542591094970703,0.03924107551574707,0.04854464530944824,0.058124542236328125,0.06116437911987305],"type":"scatter"},{"x":[59],"y":[0.06844139099121094],"type":"scatter"},{"mode":"lines","x":[60,61,62,63,64,65,66,67,68,69,70],"y":[0.0824429988861084,0.09045696258544922,0.08336424827575684,0.0673360824584961,0.04918932914733887,0.03481936454772949,0.03279280662536621,0.04274153709411621,0.05453205108642578,0.06577014923095703,0.0698232650756836],"type":"scatter"},{"x":[71],"y":[0.07654738426208496],"type":"scatter"},{"mode":"lines","x":[72,73,74,75,76,77,78,79,80,81,82],"y":[0.08668017387390137,0.09054923057556152,0.08714103698730469,0.07378411293029785,0.057663917541503906,0.039333343505859375,0.040899038314819336,0.048360347747802734,0.057848215103149414,0.06457257270812988,0.07378411293029785],"type":"scatter"},{"x":[83],"y":[0.07792949676513672],"type":"scatter"},{"mode":"lines","x":[84,85,86,87,88,89,90,91,92,93,94],"y":[0.08944368362426758,0.08972001075744629,0.08695650100708008,0.08087682723999023,0.05932211875915527,0.04955792427062988,0.044859886169433594,0.05932211875915527,0.06438851356506348,0.07544207572937012,0.08446955680847168],"type":"scatter"},{"x":[95],"y":[0.09174656867980957],"type":"scatter"},{"mode":"lines","x":[96,97,98,99,100,101,102,103,104,105,106],"y":[0.10381364822387695,0.10731387138366699,0.10427427291870117,0.09165453910827637,0.07304716110229492,0.05720353126525879,0.05222916603088379,0.06770443916320801,0.07921886444091797,0.09119367599487305,0.09275984764099121],"type":"scatter"},{"x":[107],"y":[0.09773397445678711],"type":"scatter"},{"mode":"lines","x":[108,109,110,111,112,113,114,115,116,117,118],"y":[0.11044597625732422,0.11578845977783203,0.1074061393737793,0.09312844276428223,0.07820582389831543,0.06282234191894531,0.06411218643188477,0.07645559310913086,0.08778548240661621,0.09340476989746094,0.09874725341796875],"type":"scatter"},{"x":[119],"y":[0.10556387901306152],"type":"scatter"},{"mode":"lines","x":[120,121,122,123,124,125,126,127,128,129,130],"y":[0.11597275733947754,0.12103915214538574,0.11910462379455566,0.10786676406860352,0.08916711807250977,0.07277083396911621,0.07203388214111328,0.08189034461975098,0.09635233879089355,0.10657715797424316,0.11044597625732422],"type":"scatter"},{"x":[131],"y":[0.12159180641174316],"type":"scatter"},{"mode":"lines","x":[132,133,134,135,136,137,138,139,140,141,142],"y":[0.13107967376708984,0.1377120018005371,0.13154006004333496,0.12389469146728516,0.10344505310058594,0.09165453910827637,0.08612751960754395,0.09607577323913574,0.10768246650695801,0.11634111404418945,0.1248159408569336],"type":"scatter"},{"x":[143],"y":[0.13356661796569824],"type":"scatter"},{"mode":"lines","x":[144,145,146,147,148,149,150,151,152,153,154],"y":[0.14462065696716309,0.14415979385375977,0.14038324356079102,0.12813186645507812,0.11293292045593262,0.09828686714172363,0.09791827201843262,0.10666918754577637,0.11698603630065918,0.12656617164611816,0.13126373291015625],"type":"scatter"},{"x":[155],"y":[0.13577771186828613],"type":"scatter"},{"mode":"lines","x":[156,157,158,159,160,161,162,163,164,165,166],"y":[0.14148879051208496,0.15198969841003418,0.14867353439331055,0.1375274658203125,0.11974930763244629,0.10068154335021973,0.1025240421295166,0.11394619941711426,0.1250922679901123,0.13209271430969238,0.1400148868560791],"type":"scatter"},{"x":[167],"y":[0.14112019538879395],"type":"scatter"},{"mode":"lines","x":[168,169,170,171,172,173,174,175,176,177,178],"y":[0.15926671028137207,0.1624908447265625,0.15346360206604004,0.14379167556762695,0.12794780731201172,0.11431455612182617,0.1176309585571289,0.12960577011108398,0.13927769660949707,0.14848923683166504,0.1577930450439453],"type":"scatter"},{"x":[179],"y":[0.16460943222045898],"type":"scatter"},{"mode":"lines","x":[180,181,182,183,184,185,186,187,188,189,190],"y":[0.17566323280334473,0.1846907138824463,0.18091392517089844,0.1698598861694336,0.15549015998840332,0.13890957832336426,0.13586950302124023,0.1448969841003418,0.14931845664978027,0.15585851669311523,0.16838622093200684],"type":"scatter"},{"x":[191],"y":[0.17547917366027832],"type":"scatter"},{"mode":"lines","x":[192,193,194,195,196,197,198,199,200,201,202],"y":[0.18625640869140625,0.19113850593566895,0.18211150169372559,0.17170238494873047,0.15401625633239746,0.1372511386871338,0.13679075241088867,0.14627861976623535,0.15797710418701172,0.16857051849365234,0.1752946376800537],"type":"scatter"},{"x":[203],"y":[0.1797163486480713],"type":"scatter"},{"mode":"lines","x":[204,205,206,207,208,209,210,211,212,213,214],"y":[0.19049358367919922,0.19823145866394043,0.19334936141967773,0.17999267578125,0.16138553619384766,0.14802885055541992,0.14673900604248047,0.15613484382629395,0.16912317276000977,0.17621588706970215,0.18708539009094238],"type":"scatter"},{"x":[215],"y":[0.1927964687347412],"type":"scatter"},{"mode":"lines","x":[216,217,218,219,220,221,222,223,224,225,226],"y":[0.20550847053527832,0.20532441139221191,0.19850778579711914,0.1902172565460205,0.16810965538024902,0.1522660255432129,0.1500554084777832,0.16331982612609863,0.17676854133605957,0.18653273582458496,0.19104647636413574],"type":"scatter"},{"x":[227],"y":[0.2075350284576416],"type":"scatter"},{"mode":"lines","x":[228,229,230,231,232,233,234,235,236,237,238],"y":[0.21840476989746094,0.22568154335021973,0.21868109703063965,0.20689034461975098,0.18542742729187012,0.17372894287109375,0.17363667488098145,0.18450617790222168,0.1950075626373291,0.2073507308959961,0.2102985382080078],"type":"scatter"},{"x":[239],"y":[0.22319459915161133],"type":"scatter"},{"mode":"lines","x":[240,241,242,243,244,245,246,247,248,249,250],"y":[0.232682466506958,0.23572206497192383,0.23563027381896973,0.22172069549560547,0.2025609016418457,0.18358492851257324,0.18441438674926758,0.19648122787475586,0.20707440376281738,0.21840476989746094,0.22347092628479004],"type":"scatter"},{"x":[251],"y":[0.23802495002746582],"type":"scatter"},{"mode":"lines","x":[252,253,254,255,256,257,258,259,260,261,262],"y":[0.24309158325195312,0.24696016311645508,0.24714446067810059,0.23130083084106445,0.21453571319580078,0.19841575622558594,0.20090270042419434,0.21085119247436523,0.22457623481750488,0.23461675643920898,0.23866987228393555],"type":"scatter"},{"x":[263],"y":[0.254605770111084],"type":"scatter"},{"mode":"lines","x":[264,265,266,267,268,269,270,271,272,273,274],"y":[0.2625277042388916,0.2673177719116211,0.26648855209350586,0.24889469146728516,0.2324984073638916,0.21941781044006348,0.21840476989746094,0.22908973693847656,0.23820948600769043,0.2474207878112793,0.25902724266052246],"type":"scatter"},{"x":[275],"y":[0.26897573471069336],"type":"scatter"},{"mode":"lines","x":[276,277,278,279,280,281,282,283,284,285,286],"y":[0.2779109477996826,0.2819640636444092,0.2773582935333252,0.26151442527770996,0.239959716796875,0.22586607933044434,0.22678685188293457,0.24088048934936523,0.2531318664550781,0.2625277042388916,0.2701733112335205],"type":"scatter"},{"x":[287],"y":[0.2794766426086426],"type":"scatter"},{"mode":"lines","x":[288,289,290,291,292,293,294,295,296,297,298],"y":[0.2904384136199951,0.2978997230529785,0.2897017002105713,0.27625298500061035,0.25617170333862305,0.23903846740722656,0.23931479454040527,0.24880266189575195,0.26114583015441895,0.26842308044433594,0.2796611785888672],"type":"scatter"},{"x":[299],"y":[0.285003662109375],"type":"scatter"},{"mode":"lines","x":[300,301,302,303,304,305,306,307,308,309,310],"y":[0.30370306968688965,0.3105196952819824,0.3070192337036133,0.29375481605529785,0.2770819664001465,0.25819826126098633,0.25884318351745605,0.2704496383666992,0.28343796730041504,0.2927412986755371,0.29928159713745117],"type":"scatter"},{"x":[311],"y":[0.30628228187561035],"type":"scatter"},{"mode":"lines","x":[312,313,314,315,316,317,318,319,320,321,322],"y":[0.3218495845794678,0.3256263732910156,0.3199152946472168,0.307295560836792,0.28841185569763184,0.26860713958740234,0.27109432220458984,0.2844510078430176,0.3000185489654541,0.3044400215148926,0.3130066394805908],"type":"scatter"},{"x":[323],"y":[0.3268239498138428],"type":"scatter"},{"mode":"lines","x":[324,325,326,327,328,329,330,331,332,333,334],"y":[0.33373260498046875,0.3394436836242676,0.33364033699035645,0.3175201416015625,0.3024134635925293,0.28592491149902344,0.2848196029663086,0.2975313663482666,0.3103353977203369,0.31641483306884766,0.3228631019592285],"type":"scatter"},{"x":[335],"y":[0.3299558162689209],"type":"scatter"},{"mode":"lines","x":[336,337,338,339,340,341,342,343,344,345,346],"y":[0.3447861671447754,0.35086584091186523,0.34589171409606934,0.3299558162689209,0.31079602241516113,0.3044400215148926,0.29836034774780273,0.31125640869140625,0.3229548931121826,0.3343775272369385,0.33612775802612305],"type":"scatter"},{"x":[347],"y":[0.3443257808685303],"type":"scatter"},{"mode":"lines","x":[348,349,350,351,352,353,354,355,356,357,358],"y":[0.35897207260131836,0.36588072776794434,0.3606300354003906,0.3480103015899658,0.3294954299926758,0.3153095245361328,0.31586217880249023,0.32838964462280273,0.3394436836242676,0.35077381134033203,0.36173558235168457],"type":"scatter"},{"x":[359],"y":[0.36910462379455566],"type":"scatter"},{"mode":"lines","x":[360,361,362,363,364,365,366,367,368,369,370],"y":[0.3798823356628418,0.38614606857299805,0.3818166255950928,0.3718681335449219,0.3505895137786865,0.33658814430236816,0.3402726650238037,0.3499448299407959,0.36099863052368164,0.3743553161621094,0.3776712417602539],"type":"scatter"},{"x":[371],"y":[0.38365864753723145],"type":"scatter"},{"mode":"lines","x":[372,373,374,375,376,377,378,379,380,381,382],"y":[0.39876580238342285,0.40088438987731934,0.39618659019470215,0.38338232040405273,0.3630251884460449,0.346904993057251,0.34911561012268066,0.3603537082672119,0.3728814125061035,0.38163208961486816,0.393054723739624],"type":"scatter"},{"x":[383],"y":[0.39904212951660156],"type":"scatter"},{"mode":"lines","x":[384,385,386,387,388,389,390,391,392,393,394],"y":[0.4048452377319336,0.41405677795410156,0.4049375057220459,0.39112019538879395,0.37426304817199707,0.35878777503967285,0.36164331436157227,0.3750002384185791,0.38669872283935547,0.39148855209350586,0.3996868133544922],"type":"scatter"},{"x":[395],"y":[0.41359615325927734],"type":"scatter"},{"mode":"lines","x":[396,397,398,399,400,401,402,403,404,405,406],"y":[0.4268605709075928,0.43109822273254395,0.421886682510376,0.40410828590393066,0.3826456069946289,0.3676307201385498,0.36845970153808594,0.3819088935852051,0.39406776428222656,0.4044768810272217,0.4124908447265625],"type":"scatter"},{"x":[407],"y":[0.4194915294647217],"type":"scatter"},{"mode":"lines","x":[408,409,410,411,412,413,414,415,416,417,418],"y":[0.43100595474243164,0.4355194568634033,0.4330325126647949,0.4119381904602051,0.3920412063598633,0.37380266189575195,0.3774871826171875,0.3867909908294678,0.39839720726013184,0.41147756576538086,0.4144253730773926],"type":"scatter"},{"x":[419],"y":[0.4252026081085205],"type":"scatter"},{"mode":"lines","x":[420,421,422,423,424,425,426,427,428,429,430],"y":[0.4325721263885498,0.44095420837402344,0.4348750114440918,0.4147017002105713,0.39913415908813477,0.38421177864074707,0.3850407600402832,0.3970155715942383,0.41083264350891113,0.423084020614624,0.4293479919433594],"type":"scatter"},{"x":[431],"y":[0.43920397758483887],"type":"scatter"},{"mode":"lines","x":[432,433,434,435,436,437,438,439,440,441,442],"y":[0.45071840286254883,0.454587459564209,0.4468498229980469,0.43367743492126465,0.41599106788635254,0.4000551700592041,0.40327930450439453,0.41654396057128906,0.4299006462097168,0.43855953216552734,0.4474024772644043],"type":"scatter"},{"x":[443],"y":[0.45642971992492676],"type":"scatter"},{"mode":"lines","x":[444,445,446,447,448,449,450,451,452,453,454],"y":[0.4698784351348877,0.47347092628479004,0.46886515617370605,0.454587459564209,0.4320189952850342,0.4227156639099121,0.42105770111083984,0.4345982074737549,0.44574451446533203,0.45845627784729004,0.46914148330688477],"type":"scatter"},{"x":[455],"y":[0.4776160717010498],"type":"scatter"},{"mode":"lines","x":[456,457,458,459,460,461,462,463,464,465,466],"y":[0.48139286041259766,0.48655128479003906,0.4848010540008545,0.4721813201904297,0.4524686336517334,0.4353353977203369,0.4356117248535156,0.4477708339691162,0.4602065086364746,0.4680361747741699,0.4769711494445801],"type":"scatter"},{"x":[467],"y":[0.48102426528930664],"type":"scatter"},{"mode":"lines","x":[468,469,470,471,472,473,474,475,476,477,478],"y":[0.4979734420776367,0.5005526542663574,0.49097299575805664,0.47927403450012207,0.4602985382080078,0.4422440528869629,0.4472181797027588,0.4626014232635498,0.4797348976135254,0.4878411293029785,0.4943811893463135],"type":"scatter"},{"x":[479],"y":[0.5059874057769775],"type":"scatter"},{"mode":"lines","x":[480,481,482,483,484,485,486,487,488,489,490],"y":[0.5191600322723389,0.5262527465820312,0.522291898727417,0.5116987228393555,0.4943811893463135,0.47651076316833496,0.4800112247467041,0.4904203414916992,0.5054347515106201,0.5151069164276123,0.5236735343933105],"type":"scatter"},{"x":[491],"y":[0.528831958770752],"type":"scatter"},{"mode":"lines","x":[492,493,494,495,496,497,498,499,500,501,502],"y":[0.5408990383148193,0.5406227111816406,0.5345430374145508,0.5267133712768555,0.5032241344451904,0.48378801345825195,0.48903822898864746,0.5015661716461182,0.5142779350280762,0.5252397060394287,0.5276343822479248],"type":"scatter"},{"x":[503],"y":[0.5372145175933838],"type":"scatter"},{"mode":"lines","x":[504,505,506,507,508,509,510,511,512,513,514],"y":[0.5485446453094482,0.5464260578155518,0.5475313663482666,0.5304899215698242,0.5143699645996094,0.5040531158447266,0.5043294429779053,0.5167648792266846,0.5287396907806396,0.5373067855834961,0.5458734035491943],"type":"scatter"},{"x":[515],"y":[0.5545320510864258],"type":"scatter"},{"mode":"lines","x":[516,517,518,519,520,521,522,523,524,525,526],"y":[0.5630066394805908,0.5674281120300293,0.5616250038146973,0.545781135559082,0.5282793045043945,0.5150146484375,0.5175018310546875,0.5297532081604004,0.5433862209320068,0.5551769733428955,0.5613486766815186],"type":"scatter"},{"x":[527],"y":[0.5699152946472168],"type":"scatter"},{"mode":"lines","x":[528,529,530,531,532,533,534,535,536,537,538],"y":[0.5781135559082031,0.5849299430847168,0.5827193260192871,0.5686256885528564,0.5490052700042725,0.538780689239502,0.5370304584503174,0.552689790725708,0.5669677257537842,0.5770082473754883,0.5839169025421143],"type":"scatter"},{"x":[539],"y":[0.5914702415466309],"type":"scatter"},{"mode":"lines","x":[540,541,542,543,544,545,546,547,548,549,550],"y":[0.6032609939575195,0.611182689666748,0.6082351207733154,0.5936810970306396,0.5724024772644043,0.5610723495483398,0.5607960224151611,0.5748894214630127,0.5871410369873047,0.5963523387908936,0.6044583320617676],"type":"scatter"},{"x":[551],"y":[0.6137619018554688],"type":"scatter"},{"mode":"lines","x":[552,553,554,555,556,557,558,559,560,561,562],"y":[0.6273951530456543,0.6297898292541504,0.6212232112884521,0.600773811340332,0.5871410369873047,0.5711126327514648,0.5729551315307617,0.5886144638061523,0.6010501384735107,0.6098010540008545,0.6215918064117432],"type":"scatter"},{"x":[563],"y":[0.6311719417572021],"type":"scatter"},{"mode":"lines","x":[564,565,566,567,568,569,570,571,572,573,574],"y":[0.6452653408050537,0.6467392444610596,0.6445283889770508,0.6309874057769775,0.6125645637512207,0.5937731266021729,0.5965366363525391,0.6089720726013184,0.6252763271331787,0.6369748115539551,0.6445283889770508],"type":"scatter"},{"x":[575],"y":[0.6487655639648438],"type":"scatter"},{"mode":"lines","x":[576,577,578,579,580,581,582,583,584,585,586],"y":[0.6666359901428223,0.6705048084259033,0.6614775657653809,0.6468312740325928,0.6279478073120117,0.6135778427124023,0.6162490844726562,0.6256449222564697,0.6410279273986816,0.6509766578674316,0.660372257232666],"type":"scatter"},{"x":[587],"y":[0.6667280197143555],"type":"scatter"},{"mode":"lines","x":[588,589,590,591,592,593,594,595,596,597,598],"y":[0.6844143867492676,0.6848747730255127,0.6807293891906738,0.6659913063049316,0.6430544853210449,0.6334748268127441,0.6350405216217041,0.647291898727417,0.6610169410705566,0.6756632328033447,0.6782424449920654],"type":"scatter"},{"x":[599],"y":[0.6802690029144287],"type":"scatter"},{"mode":"lines","x":[600,601,602,603,604,605,606,607,608,609,610],"y":[0.6899409294128418,0.7032978534698486,0.6960206031799316,0.6833086013793945,0.6622145175933838,0.653832197189331,0.6519896984100342,0.6630434989929199,0.675755500793457,0.6884675025939941,0.6933493614196777],"type":"scatter"},{"x":[611],"y":[0.7056927680969238],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"Months since March 1958"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"CO2 Concentration"}},"legend":{"tracegroupgap":0},"title":{"text":"Sunspots per month since 1749-01"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e6e417d3-8197-4237-b50c-011fdace4f29');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="model-and-training-parameters" class="level2">
<h2 class="anchored" data-anchor-id="model-and-training-parameters">Model and training parameters</h2>
<div class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#USER PARAM</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units<span class="op">=</span><span class="dv">3</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span><span class="dv">60</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>f_batch<span class="op">=</span><span class="fl">0.2</span>    <span class="co">#fraction used for batch size</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>optimizer<span class="op">=</span><span class="st">"RMSprop"</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span><span class="fl">0.2</span></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape,p,trainY.shape)</span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a><span class="co"># trainY=trainY.reshape(trainY.shape[0],1)</span></span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a><span class="co"># testY=testY.reshape(testY.shape[0],1)</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p,trainX.shape,testX.shape,trainY.shape,testY.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(51, 11, 1) 12 (51,)
12 (51, 11, 1) (12, 11, 1) (51,) (12,)</code></pre>
</div>
</div>
</section>
<section id="create-model" class="level2">
<h2 class="anchored" data-anchor-id="create-model">Create model</h2>
<div class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> tensorflow.keras <span class="im">import</span> regularizers</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#CREATE MODEL</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> Sequential()</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a><span class="co">#COMMENT/UNCOMMENT TO USE RNN, LSTM,GRU</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(LSTM(</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a><span class="co"># model.add(SimpleRNN(</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>model.add(GRU(</span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>recurrent_hidden_units,</span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>return_sequences<span class="op">=</span><span class="va">False</span>,</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>input_shape<span class="op">=</span>(trainX.shape[<span class="dv">1</span>],trainX.shape[<span class="dv">2</span>]), </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>recurrent_dropout<span class="op">=</span><span class="fl">0.8</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>recurrent_regularizer<span class="op">=</span>regularizers.L2(<span class="fl">1e-1</span>),</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>activation<span class="op">=</span><span class="st">'tanh'</span>)</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>          ) </span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a><span class="co">#NEED TO TAKE THE OUTPUT RNN AND CONVERT TO SCALAR </span></span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>model.add(Dense(units<span class="op">=</span><span class="dv">1</span>, activation<span class="op">=</span><span class="st">'linear'</span>))</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a><span class="co"># COMPILE THE MODEL </span></span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>model.<span class="bu">compile</span>(loss<span class="op">=</span><span class="st">'MeanSquaredError'</span>, optimizer<span class="op">=</span>optimizer)</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>model.summary()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model: "sequential"
_________________________________________________________________
 Layer (type)                Output Shape              Param #   
=================================================================
 gru (GRU)                   (None, 3)                 54        
                                                                 
 dense (Dense)               (None, 1)                 4         
                                                                 
=================================================================
Total params: 58
Trainable params: 58
Non-trainable params: 0
_________________________________________________________________</code></pre>
</div>
</div>
</section>
<section id="train-model" class="level2">
<h2 class="anchored" data-anchor-id="train-model">Train model</h2>
<div class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#TRAIN MODEL</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>history <span class="op">=</span> model.fit(</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>trainX, trainY, </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>epochs<span class="op">=</span>epochs, </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>batch_size<span class="op">=</span><span class="bu">int</span>(f_batch<span class="op">*</span>trainX.shape[<span class="dv">0</span>]), </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>validation_split<span class="op">=</span>validation_split,  <span class="co"># BEING "SLOPPY WITH CROSS VALIDATION" HERE FOR TIME-SERIES</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>verbose<span class="op">=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Epoch 1/60
4/4 - 4s - loss: 0.5047 - val_loss: 1.2623 - 4s/epoch - 1s/step
Epoch 2/60
4/4 - 0s - loss: 0.4825 - val_loss: 1.1819 - 95ms/epoch - 24ms/step
Epoch 3/60
4/4 - 0s - loss: 0.4461 - val_loss: 1.1225 - 97ms/epoch - 24ms/step
Epoch 4/60
4/4 - 0s - loss: 0.4158 - val_loss: 1.0692 - 84ms/epoch - 21ms/step
Epoch 5/60
4/4 - 0s - loss: 0.3982 - val_loss: 1.0208 - 79ms/epoch - 20ms/step
Epoch 6/60
4/4 - 0s - loss: 0.3843 - val_loss: 0.9750 - 94ms/epoch - 23ms/step
Epoch 7/60
4/4 - 0s - loss: 0.3654 - val_loss: 0.9313 - 94ms/epoch - 24ms/step
Epoch 8/60
4/4 - 0s - loss: 0.3603 - val_loss: 0.8886 - 100ms/epoch - 25ms/step
Epoch 9/60
4/4 - 0s - loss: 0.3351 - val_loss: 0.8505 - 95ms/epoch - 24ms/step
Epoch 10/60
4/4 - 0s - loss: 0.3291 - val_loss: 0.8133 - 96ms/epoch - 24ms/step
Epoch 11/60
4/4 - 0s - loss: 0.3130 - val_loss: 0.7783 - 94ms/epoch - 24ms/step
Epoch 12/60
4/4 - 0s - loss: 0.3018 - val_loss: 0.7457 - 85ms/epoch - 21ms/step
Epoch 13/60
4/4 - 0s - loss: 0.2984 - val_loss: 0.7136 - 99ms/epoch - 25ms/step
Epoch 14/60
4/4 - 0s - loss: 0.2819 - val_loss: 0.6836 - 104ms/epoch - 26ms/step
Epoch 15/60
4/4 - 0s - loss: 0.2760 - val_loss: 0.6537 - 87ms/epoch - 22ms/step
Epoch 16/60
4/4 - 0s - loss: 0.2732 - val_loss: 0.6259 - 91ms/epoch - 23ms/step
Epoch 17/60
4/4 - 0s - loss: 0.2661 - val_loss: 0.5993 - 98ms/epoch - 25ms/step
Epoch 18/60
4/4 - 0s - loss: 0.2513 - val_loss: 0.5782 - 101ms/epoch - 25ms/step
Epoch 19/60
4/4 - 0s - loss: 0.2470 - val_loss: 0.5559 - 100ms/epoch - 25ms/step
Epoch 20/60
4/4 - 0s - loss: 0.2414 - val_loss: 0.5353 - 97ms/epoch - 24ms/step
Epoch 21/60
4/4 - 0s - loss: 0.2380 - val_loss: 0.5162 - 96ms/epoch - 24ms/step
Epoch 22/60
4/4 - 0s - loss: 0.2305 - val_loss: 0.4983 - 100ms/epoch - 25ms/step
Epoch 23/60
4/4 - 0s - loss: 0.2229 - val_loss: 0.4847 - 98ms/epoch - 24ms/step
Epoch 24/60
4/4 - 0s - loss: 0.2151 - val_loss: 0.4713 - 97ms/epoch - 24ms/step
Epoch 25/60
4/4 - 0s - loss: 0.2140 - val_loss: 0.4584 - 96ms/epoch - 24ms/step
Epoch 26/60
4/4 - 0s - loss: 0.2103 - val_loss: 0.4500 - 99ms/epoch - 25ms/step
Epoch 27/60
4/4 - 0s - loss: 0.2061 - val_loss: 0.4402 - 99ms/epoch - 25ms/step
Epoch 28/60
4/4 - 0s - loss: 0.2035 - val_loss: 0.4307 - 97ms/epoch - 24ms/step
Epoch 29/60
4/4 - 0s - loss: 0.1986 - val_loss: 0.4182 - 97ms/epoch - 24ms/step
Epoch 30/60
4/4 - 0s - loss: 0.1930 - val_loss: 0.4086 - 92ms/epoch - 23ms/step
Epoch 31/60
4/4 - 0s - loss: 0.1928 - val_loss: 0.4001 - 106ms/epoch - 26ms/step
Epoch 32/60
4/4 - 0s - loss: 0.1847 - val_loss: 0.3921 - 103ms/epoch - 26ms/step
Epoch 33/60
4/4 - 0s - loss: 0.1775 - val_loss: 0.3840 - 96ms/epoch - 24ms/step
Epoch 34/60
4/4 - 0s - loss: 0.1789 - val_loss: 0.3762 - 113ms/epoch - 28ms/step
Epoch 35/60
4/4 - 0s - loss: 0.1729 - val_loss: 0.3666 - 117ms/epoch - 29ms/step
Epoch 36/60
4/4 - 0s - loss: 0.1683 - val_loss: 0.3605 - 122ms/epoch - 31ms/step
Epoch 37/60
4/4 - 0s - loss: 0.1647 - val_loss: 0.3523 - 113ms/epoch - 28ms/step
Epoch 38/60
4/4 - 0s - loss: 0.1594 - val_loss: 0.3455 - 116ms/epoch - 29ms/step
Epoch 39/60
4/4 - 0s - loss: 0.1567 - val_loss: 0.3391 - 112ms/epoch - 28ms/step
Epoch 40/60
4/4 - 0s - loss: 0.1506 - val_loss: 0.3303 - 118ms/epoch - 29ms/step
Epoch 41/60
4/4 - 0s - loss: 0.1505 - val_loss: 0.3221 - 114ms/epoch - 29ms/step
Epoch 42/60
4/4 - 0s - loss: 0.1459 - val_loss: 0.3199 - 124ms/epoch - 31ms/step
Epoch 43/60
4/4 - 0s - loss: 0.1422 - val_loss: 0.3127 - 124ms/epoch - 31ms/step
Epoch 44/60
4/4 - 0s - loss: 0.1383 - val_loss: 0.3087 - 130ms/epoch - 32ms/step
Epoch 45/60
4/4 - 0s - loss: 0.1365 - val_loss: 0.2987 - 116ms/epoch - 29ms/step
Epoch 46/60
4/4 - 0s - loss: 0.1293 - val_loss: 0.2907 - 122ms/epoch - 30ms/step
Epoch 47/60
4/4 - 0s - loss: 0.1271 - val_loss: 0.2862 - 113ms/epoch - 28ms/step
Epoch 48/60
4/4 - 0s - loss: 0.1242 - val_loss: 0.2769 - 70ms/epoch - 18ms/step
Epoch 49/60
4/4 - 0s - loss: 0.1221 - val_loss: 0.2699 - 78ms/epoch - 19ms/step
Epoch 50/60
4/4 - 0s - loss: 0.1168 - val_loss: 0.2644 - 104ms/epoch - 26ms/step
Epoch 51/60
4/4 - 0s - loss: 0.1154 - val_loss: 0.2574 - 103ms/epoch - 26ms/step
Epoch 52/60
4/4 - 0s - loss: 0.1121 - val_loss: 0.2504 - 95ms/epoch - 24ms/step
Epoch 53/60
4/4 - 0s - loss: 0.1083 - val_loss: 0.2475 - 99ms/epoch - 25ms/step
Epoch 54/60
4/4 - 0s - loss: 0.1076 - val_loss: 0.2411 - 101ms/epoch - 25ms/step
Epoch 55/60
4/4 - 0s - loss: 0.1044 - val_loss: 0.2359 - 81ms/epoch - 20ms/step
Epoch 56/60
4/4 - 0s - loss: 0.1006 - val_loss: 0.2303 - 105ms/epoch - 26ms/step
Epoch 57/60
4/4 - 0s - loss: 0.0969 - val_loss: 0.2249 - 95ms/epoch - 24ms/step
Epoch 58/60
4/4 - 0s - loss: 0.0950 - val_loss: 0.2187 - 83ms/epoch - 21ms/step
Epoch 59/60
4/4 - 0s - loss: 0.0937 - val_loss: 0.2138 - 90ms/epoch - 23ms/step
Epoch 60/60
4/4 - 0s - loss: 0.0895 - val_loss: 0.2081 - 113ms/epoch - 28ms/step</code></pre>
</div>
</div>
</section>
<section id="visualize-fitting-history" class="level2">
<h2 class="anchored" data-anchor-id="visualize-fitting-history">Visualize fitting history</h2>
<div class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#HISTORY PLOT</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>epochs_steps <span class="op">=</span> [<span class="op">*</span><span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(history.history[<span class="st">'loss'</span>]))]</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># MAKE PREDICTIONS</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>train_predict <span class="op">=</span> model.predict(trainX).squeeze()</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>test_predict <span class="op">=</span> model.predict(testX).squeeze()</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainX.shape, train_predict.shape,trainY.shape,testX.shape, test_predict.shape,testY.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>2/2 [==============================] - 1s 1ms/step
1/1 [==============================] - 0s 54ms/step
(51, 11, 1) (51,) (51,) (12, 11, 1) (12,) (12,)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co">#COMPUTE RMSE</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(trainY.shape, train_predict.shape)</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>train_rmse <span class="op">=</span> np.sqrt(mean_squared_error(trainY, train_predict))</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>test_rmse <span class="op">=</span> np.sqrt(mean_squared_error(testY, test_predict))</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((trainY<span class="op">-</span>train_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.mean((testY<span class="op">-</span>test_predict)<span class="op">**</span><span class="fl">2.0</span>))</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Train MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (train_rmse<span class="op">**</span><span class="fl">2.0</span>,train_rmse))</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">'Test MSE = </span><span class="sc">%.5f</span><span class="st"> RMSE = </span><span class="sc">%.5f</span><span class="st">'</span> <span class="op">%</span> (test_rmse<span class="op">**</span><span class="fl">2.0</span>,test_rmse))    </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(51,) (51,)
0.046757948
0.3968842
Train MSE = 0.04676 RMSE = 0.21624
Test MSE = 0.39688 RMSE = 0.62999</code></pre>
</div>
</div>
<div class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOTLY PLOT</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>plotly_line_plot([epochs_steps,epochs_steps],[history.history[<span class="st">'loss'</span>],history.history[<span class="st">'val_loss'</span>]],title<span class="op">=</span><span class="st">"Sunspots per month since 1749-01"</span>,x_label<span class="op">=</span><span class="st">"training epochs"</span>,y_label<span class="op">=</span><span class="st">"loss (MSE)"</span>)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(history.history[<span class="st">'loss'</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="a17ef577-3f46-47c1-b8e2-fb1def200ade" class="plotly-graph-div" style="height:525px; width:100%;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("a17ef577-3f46-47c1-b8e2-fb1def200ade")) {                    Plotly.newPlot(                        "a17ef577-3f46-47c1-b8e2-fb1def200ade",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","line":{"color":"#636efa","dash":"solid"},"marker":{"symbol":"circle"},"mode":"lines","name":"","orientation":"v","showlegend":false,"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"xaxis":"x","y":[0.5047488212585449,0.48250818252563477,0.44607725739479065,0.4157511591911316,0.3982289433479309,0.38434669375419617,0.36540862917900085,0.3603326678276062,0.3350667655467987,0.3290526568889618,0.3129689395427704,0.3018222451210022,0.2984009385108948,0.2819467782974243,0.27599412202835083,0.2731618881225586,0.2660587430000305,0.2512662708759308,0.24698388576507568,0.24139201641082764,0.23800456523895264,0.23049971461296082,0.22285766899585724,0.21511372923851013,0.21396541595458984,0.21032771468162537,0.20612254738807678,0.20345744490623474,0.1986091583967209,0.19301706552505493,0.19275657832622528,0.18468406796455383,0.17752352356910706,0.1789451390504837,0.17290137708187103,0.1683419942855835,0.1647375077009201,0.15942975878715515,0.15667292475700378,0.15064620971679688,0.1504872590303421,0.1459072381258011,0.1421777307987213,0.13825400173664093,0.13654674589633942,0.12925390899181366,0.1270645707845688,0.12423168122768402,0.12211966514587402,0.11678657680749893,0.1153644472360611,0.11207455396652222,0.10825835168361664,0.10758113861083984,0.10436172783374786,0.10062526166439056,0.09688971191644669,0.09498926997184753,0.0936746671795845,0.08947247266769409],"yaxis":"y","type":"scatter"},{"mode":"lines","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59],"y":[1.2622861862182617,1.1818525791168213,1.1225358247756958,1.069205403327942,1.0208426713943481,0.9750415682792664,0.9313239455223083,0.8886167407035828,0.850531816482544,0.8133482336997986,0.7782526016235352,0.7457315325737,0.7135761380195618,0.6835992336273193,0.6536994576454163,0.625865638256073,0.5993165373802185,0.578193187713623,0.5559420585632324,0.5352647304534912,0.5161888003349304,0.4982545077800751,0.4846544563770294,0.4712974727153778,0.458441823720932,0.45002982020378113,0.4402066171169281,0.4306623637676239,0.4182044267654419,0.4085555076599121,0.40005064010620117,0.39214208722114563,0.38403642177581787,0.3762313723564148,0.36659640073776245,0.3605344891548157,0.35231468081474304,0.3455343246459961,0.3391116261482239,0.33033472299575806,0.32207155227661133,0.3199290633201599,0.31272825598716736,0.3086635172367096,0.29873543977737427,0.29073676466941833,0.28616321086883545,0.2769160866737366,0.2698836624622345,0.26440754532814026,0.25740310549736023,0.25042274594306946,0.2474822849035263,0.24111948907375336,0.2358853816986084,0.23027493059635162,0.22488775849342346,0.2186572551727295,0.21375726163387299,0.20807532966136932],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"training epochs"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"loss (MSE)"}},"legend":{"tracegroupgap":0},"title":{"text":"Sunspots per month since 1749-01"},"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('a17ef577-3f46-47c1-b8e2-fb1def200ade');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.5047488212585449, 0.48250818252563477, 0.44607725739479065, 0.4157511591911316, 0.3982289433479309, 0.38434669375419617, 0.36540862917900085, 0.3603326678276062, 0.3350667655467987, 0.3290526568889618, 0.3129689395427704, 0.3018222451210022, 0.2984009385108948, 0.2819467782974243, 0.27599412202835083, 0.2731618881225586, 0.2660587430000305, 0.2512662708759308, 0.24698388576507568, 0.24139201641082764, 0.23800456523895264, 0.23049971461296082, 0.22285766899585724, 0.21511372923851013, 0.21396541595458984, 0.21032771468162537, 0.20612254738807678, 0.20345744490623474, 0.1986091583967209, 0.19301706552505493, 0.19275657832622528, 0.18468406796455383, 0.17752352356910706, 0.1789451390504837, 0.17290137708187103, 0.1683419942855835, 0.1647375077009201, 0.15942975878715515, 0.15667292475700378, 0.15064620971679688, 0.1504872590303421, 0.1459072381258011, 0.1421777307987213, 0.13825400173664093, 0.13654674589633942, 0.12925390899181366, 0.1270645707845688, 0.12423168122768402, 0.12211966514587402, 0.11678657680749893, 0.1153644472360611, 0.11207455396652222, 0.10825835168361664, 0.10758113861083984, 0.10436172783374786, 0.10062526166439056, 0.09688971191644669, 0.09498926997184753, 0.0936746671795845, 0.08947247266769409]</code></pre>
</div>
</div>
<div class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># SIMPLE PLOT </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>plt.figure()</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'loss'</span>], <span class="st">'bo'</span>, label<span class="op">=</span><span class="st">'Training loss'</span>)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>plt.plot(epochs_steps, history.history[<span class="st">'val_loss'</span>], <span class="st">'b'</span>, label<span class="op">=</span><span class="st">'Validation loss'</span>)</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>&lt;matplotlib.legend.Legend at 0x1e15259d960&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="sunspot_files/figure-html/cell-20-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="visualize-parity-plot" class="level2">
<h2 class="anchored" data-anchor-id="visualize-parity-plot">Visualize parity plot</h2>
<div class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># GET DATA</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="co"># GENERATE PLOTLY FIGURE</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> px.scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>train_predict,height<span class="op">=</span><span class="dv">600</span>,width<span class="op">=</span><span class="dv">800</span>)</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>testY,y<span class="op">=</span>test_predict,mode<span class="op">=</span><span class="st">"markers"</span>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>fig.add_scatter(x<span class="op">=</span>trainY,y<span class="op">=</span>trainY, mode<span class="op">=</span><span class="st">'lines'</span>)</span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>fig.update_layout(</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>    xaxis_title<span class="op">=</span><span class="st">"y_pred"</span>,</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>    yaxis_title<span class="op">=</span><span class="st">"y_data"</span>,</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    template<span class="op">=</span><span class="st">"plotly_white"</span>,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>    showlegend<span class="op">=</span><span class="va">False</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>fig.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">

<div>                            <div id="eca76974-5871-4bbb-b7d4-5abcccf81d77" class="plotly-graph-div" style="height:600px; width:800px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("eca76974-5871-4bbb-b7d4-5abcccf81d77")) {                    Plotly.newPlot(                        "eca76974-5871-4bbb-b7d4-5abcccf81d77",                        [{"hovertemplate":"x=%{x}<br>y=%{y}<extra></extra>","legendgroup":"","marker":{"color":"#636efa","symbol":"circle"},"mode":"markers","name":"","orientation":"v","showlegend":false,"x":[0.038872480392456055,0.0474390983581543,0.05628228187561035,0.06678342819213867,0.06844139099121094,0.07654738426208496,0.07792949676513672,0.09174656867980957,0.09773397445678711,0.10556387901306152,0.12159180641174316,0.13356661796569824,0.13577771186828613,0.14112019538879395,0.16460943222045898,0.17547917366027832,0.1797163486480713,0.1927964687347412,0.2075350284576416,0.22319459915161133,0.23802495002746582,0.254605770111084,0.26897573471069336,0.2794766426086426,0.285003662109375,0.30628228187561035,0.3268239498138428,0.3299558162689209,0.3443257808685303,0.36910462379455566,0.38365864753723145,0.39904212951660156,0.41359615325927734,0.4194915294647217,0.4252026081085205,0.43920397758483887,0.45642971992492676,0.4776160717010498,0.48102426528930664,0.5059874057769775,0.528831958770752,0.5372145175933838,0.5545320510864258,0.5699152946472168,0.5914702415466309,0.6137619018554688,0.6311719417572021,0.6487655639648438,0.6667280197143555,0.6802690029144287,0.7056927680969238],"xaxis":"x","y":[0.2508694529533386,0.2509770691394806,0.25105375051498413,0.2512034773826599,0.25128424167633057,0.25144529342651367,0.25144752860069275,0.2516387701034546,0.2517797350883484,0.2518295645713806,0.25196877121925354,0.25205397605895996,0.2521161437034607,0.25218021869659424,0.25230857729911804,0.2522331774234772,0.25231462717056274,0.25232791900634766,0.25233936309814453,0.25230956077575684,0.25224769115448,0.2521836757659912,0.2520032525062561,0.2519053816795349,0.251766175031662,0.2515186667442322,0.2513100504875183,0.25112414360046387,0.2508680820465088,0.25035417079925537,0.24993203580379486,0.24954769015312195,0.2493547797203064,0.2489577829837799,0.24886450171470642,0.2484307587146759,0.24784120917320251,0.24705415964126587,0.24673309922218323,0.24601858854293823,0.24476346373558044,0.24451471865177155,0.24372747540473938,0.24292713403701782,0.2417612373828888,0.24064788222312927,0.2397015392780304,0.238270103931427,0.23731303215026855,0.23606161773204803,0.23510390520095825],"yaxis":"y","type":"scatter"},{"mode":"markers","x":[0.7283530235290527,0.7450258731842041,0.7677781581878662,0.7885963916778564,0.8083088397979736,0.8317983150482178,0.8652358055114746,0.8817243576049805,0.9082536697387695,0.9320189952850342,0.949613094329834,0.974207878112793],"y":[0.23387347161769867,0.23261050879955292,0.2308850884437561,0.229228675365448,0.22774648666381836,0.22553257644176483,0.22339583933353424,0.22170057892799377,0.2196982204914093,0.21755358576774597,0.21551840007305145,0.21347211301326752],"type":"scatter"},{"mode":"lines","x":[0.038872480392456055,0.0474390983581543,0.05628228187561035,0.06678342819213867,0.06844139099121094,0.07654738426208496,0.07792949676513672,0.09174656867980957,0.09773397445678711,0.10556387901306152,0.12159180641174316,0.13356661796569824,0.13577771186828613,0.14112019538879395,0.16460943222045898,0.17547917366027832,0.1797163486480713,0.1927964687347412,0.2075350284576416,0.22319459915161133,0.23802495002746582,0.254605770111084,0.26897573471069336,0.2794766426086426,0.285003662109375,0.30628228187561035,0.3268239498138428,0.3299558162689209,0.3443257808685303,0.36910462379455566,0.38365864753723145,0.39904212951660156,0.41359615325927734,0.4194915294647217,0.4252026081085205,0.43920397758483887,0.45642971992492676,0.4776160717010498,0.48102426528930664,0.5059874057769775,0.528831958770752,0.5372145175933838,0.5545320510864258,0.5699152946472168,0.5914702415466309,0.6137619018554688,0.6311719417572021,0.6487655639648438,0.6667280197143555,0.6802690029144287,0.7056927680969238],"y":[0.038872480392456055,0.0474390983581543,0.05628228187561035,0.06678342819213867,0.06844139099121094,0.07654738426208496,0.07792949676513672,0.09174656867980957,0.09773397445678711,0.10556387901306152,0.12159180641174316,0.13356661796569824,0.13577771186828613,0.14112019538879395,0.16460943222045898,0.17547917366027832,0.1797163486480713,0.1927964687347412,0.2075350284576416,0.22319459915161133,0.23802495002746582,0.254605770111084,0.26897573471069336,0.2794766426086426,0.285003662109375,0.30628228187561035,0.3268239498138428,0.3299558162689209,0.3443257808685303,0.36910462379455566,0.38365864753723145,0.39904212951660156,0.41359615325927734,0.4194915294647217,0.4252026081085205,0.43920397758483887,0.45642971992492676,0.4776160717010498,0.48102426528930664,0.5059874057769775,0.528831958770752,0.5372145175933838,0.5545320510864258,0.5699152946472168,0.5914702415466309,0.6137619018554688,0.6311719417572021,0.6487655639648438,0.6667280197143555,0.6802690029144287,0.7056927680969238],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"ticks":""},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"ticks":""}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]],"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]},"colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"white","showlakes":true,"showland":true,"subunitcolor":"#C8D4E3"},"hoverlabel":{"align":"left"},"hovermode":"closest","mapbox":{"style":"light"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"bgcolor":"white","radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","gridwidth":2,"linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8"}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"ternary":{"aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"bgcolor":"white","caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"title":{"x":0.05},"xaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2},"yaxis":{"automargin":true,"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","zerolinewidth":2}}},"xaxis":{"anchor":"y","domain":[0.0,1.0],"title":{"text":"y_pred"}},"yaxis":{"anchor":"x","domain":[0.0,1.0],"title":{"text":"y_data"}},"legend":{"tracegroupgap":0},"margin":{"t":60},"height":600,"width":800,"showlegend":false},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('eca76974-5871-4bbb-b7d4-5abcccf81d77');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="visualize-predictions-2" class="level2">
<h2 class="anchored" data-anchor-id="visualize-predictions-2">Visualize predictions-2</h2>
<div class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PLOT THE RESULT</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_result(trainY, testY, train_predict, test_predict):</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">6</span>), dpi<span class="op">=</span><span class="dv">80</span>)</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ORIGINAL DATA</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(X.shape,Y.shape)</span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, Y,<span class="st">'o'</span>, label<span class="op">=</span><span class="st">'target'</span>)</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>    plt.plot(X_ind, X,<span class="st">'.'</span>, label<span class="op">=</span><span class="st">'training points'</span>)<span class="op">;</span>     </span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'r.'</span>, label<span class="op">=</span><span class="st">'prediction'</span>)<span class="op">;</span>    </span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>    plt.plot(Y_ind, train_predict,<span class="st">'-'</span>)<span class="op">;</span>    </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">'Observation number after given time steps'</span>)</span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">'Sunspots scaled'</span>)</span>
<span id="cb33-13"><a href="#cb33-13" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">'Actual and Predicted Values. The Red Line Separates The Training And Test Examples'</span>)</span>
<span id="cb33-14"><a href="#cb33-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb33-15"><a href="#cb33-15" aria-hidden="true" tabindex="-1"></a>plot_result(trainY, testY, train_predict, test_predict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(561,) (51,)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="sunspot_files/figure-html/cell-22-output-2.png" class="img-fluid"></p>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./ftsm.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Financial Time Series Models (ARCH/GARCH)</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./conc.html" class="pagination-link">
        <span class="nav-page-text">Conclusions</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>